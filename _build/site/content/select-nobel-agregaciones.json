{"version":1,"kind":"Article","sha256":"420b3ee2d47da75e96f0c2371a81c7b3560adf673190e20690968f6752571fda","slug":"select-nobel-agregaciones","location":"/select_nobel_agregaciones.md","dependencies":[],"frontmatter":{"title":"Agregación por categorías","content_includes_title":false,"authors":[{"nameParsed":{"literal":"José Luis Fernández Vindel","given":"José Luis Fernández","family":"Vindel"},"name":"José Luis Fernández Vindel","affiliations":["UNED"],"id":"contributors-myst-generated-uid-0"}],"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"affiliations":[{"id":"UNED","name":"UNED"}],"numbering":{"title":{"offset":2}},"exports":[{"format":"md","filename":"select_nobel_agregaciones.md","url":"/select_nobel_agregac-d01d63a4441821ce8d74374b51bc8ce2.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"El conjunto de resultados devuelto por los patrones de búsqueda ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"K70UObz0Io"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"se pueden partir en clases disjuntas","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"OfjF6EVmZF"}],"key":"OWWXABWXv0"},{"type":"text","value":". Esto permite ejecutar algunos cálculos sobre los elementos agregados de cada clase.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"nCN6ClGbnX"}],"key":"tcjdWGepGL"},{"type":"heading","depth":2,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Cálculos sobre una categoría","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ibgmOt2J0f"}],"identifier":"c-lculos-sobre-una-categor-a","label":"Cálculos sobre una categoría","html_id":"c-lculos-sobre-una-categor-a","implicit":true,"key":"ckUIHKvTsv"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"La siguiente consulta mantiene todos los resultados en un misma clase y tan sólo devuelve un número: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"J6JQRzTNwk"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"el recuento de los premiados que tenían menos de 50 años","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"aKf9nRfnpA"}],"key":"deD77gvHhV"},{"type":"text","value":" en la fecha de concesión de su premio Nobel. La función COUNT actúa sobre todas las instancias devueltas de la variable ?premiado y presenta su resultado en una variable nueva, como es ?numPremiado.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LyLTZmypUn"}],"key":"by7Oe12qGL"},{"type":"admonition","kind":"hint","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Consulta: recuento de premiados menores de 50","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jX1yUXLMY8"}],"key":"BWtnpacx12"},{"type":"code","lang":"SPARQL","value":"PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\nPREFIX nobel: <http://data.nobelprize.org/terms/>\nPREFIX dbp: <http://dbpedia.org/property/>\n\nSELECT (COUNT(DISTINCT ?premiado) AS ?numPremiado)\nWHERE {\n  ?premiado rdf:type nobel:Laureate .\n  ?premiado dbp:dateOfBirth ?fechaNac .\n  ?premiado nobel:laureateAward ?distinciónIndiv .\n  ?distinciónIndiv nobel:year ?añoNobel .\n  BIND ( (?añoNobel - year(?fechaNac)) AS ?edadNobel)\n  FILTER ( ?edadNobel < 50 )\n}","position":{"start":{"line":12,"column":1},"end":{"line":26,"column":1}},"key":"Mr2rEcVAoZ"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"link","url":"https://data.nobelprize.org/sparql","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Punto de consulta","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"JMewO4U2Ak"}],"urlSource":"https://data.nobelprize.org/sparql","key":"W4iOP3yo47"}],"key":"h2DYa9aCO3"}],"class":"dropdown","label":"query-recuento","identifier":"query-recuento","open":true,"html_id":"query-recuento","key":"QcxX2NW3l9"},{"type":"admonition","kind":"hint","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Consulta: edad promedio en la concesión del Nobel","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"yrHU5xbnlo"}],"key":"ImCt9jagiM"},{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Si las instancias devueltas son números, se puede calcular su máximo, mínimo o promedio. Esta consulta devuelve la edad promedio que tenían los premiados Nobel en la fecha de su concesión.","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"aWL6ODSMjr"}],"key":"TPsSWTMoeT"},{"type":"code","lang":"SPARQL","value":"PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\nPREFIX nobel: <http://data.nobelprize.org/terms/>\nPREFIX dbp: <http://dbpedia.org/property/>\n\nSELECT (AVG(?edadNobel) AS ?edadNobelPromedio)\nWHERE {\n  ?premiado rdf:type nobel:Laureate .\n  ?premiado dbp:dateOfBirth ?fechaNac .\n  ?premiado nobel:laureateAward ?distinciónIndiv .\n  ?distinciónIndiv nobel:year ?añoNobel .\n  BIND ( (?añoNobel - year(?fechaNac)) AS ?edadNobel)\n}","position":{"start":{"line":36,"column":1},"end":{"line":49,"column":1}},"key":"Zc8DiMQmec"},{"type":"paragraph","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"link","url":"https://data.nobelprize.org/sparql","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"Punto de consulta","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"OLxgd716vl"}],"urlSource":"https://data.nobelprize.org/sparql","key":"YNjJD8wl2y"}],"key":"VMB7EoRnjI"}],"class":"dropdown","label":"query-edad-promedio-concesion","identifier":"query-edad-promedio-concesion","open":true,"html_id":"query-edad-promedio-concesion","key":"l1BDJza6v2"},{"type":"heading","depth":2,"position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"Agrupación por categorías","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"EmY2NdR3Gq"}],"identifier":"agrupaci-n-por-categor-as","label":"Agrupación por categorías","html_id":"agrupaci-n-por-categor-as","implicit":true,"key":"pBheSVv9H9"},{"type":"paragraph","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"En la siguiente consulta, el patrón de búsqueda devuelve valores para las variables (?premioNobel, ?premiado, ?categoría). La instrucción GROUP BY produce una partición de estas instancias: ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"QEWPuGlkve"},{"type":"strong","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"pertenecen al mismo agrupamiento aquellas instancias que coincidan en tener el mismo valor","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"GLclbbxdA3"}],"key":"likS8fccSo"},{"type":"text","value":" para la variable escogida.","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"pWwZuel9Oq"}],"key":"ThReuhAmFi"},{"type":"paragraph","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"Dentro de cada agrupamiento, sobre los valores del resto de variables, se puede ejecutar un cálculo agregado. La siguiente consulta devuelve los diversos tipos de premios Nobel y, dentro de cada uno, el número de premiados.","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"s1IRJ9dBrt"}],"key":"GGAJtJWcO5"},{"type":"admonition","kind":"hint","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Consulta: recuento de premiados por cada una de las distintas categorías","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"tmnNIqQakX"}],"key":"KK1NVgNjHR"},{"type":"code","lang":"SPARQL","value":"PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\nPREFIX nobel: <http://data.nobelprize.org/terms/>\n\nSELECT ?categoría  (COUNT(DISTINCT ?premiado) AS ?numPremiadosCategoría)\nWHERE {\n  ?premioNobel rdf:type nobel:NobelPrize .\n  ?premioNobel nobel:laureate ?premiado .\n  ?premioNobel nobel:category ?categoría .\n}\nGROUP BY ?categoría ","position":{"start":{"line":63,"column":1},"end":{"line":74,"column":1}},"key":"EMUA8Blsny"},{"type":"paragraph","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"link","url":"https://data.nobelprize.org/sparql","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"Punto de consulta","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"IvzfNuIcaC"}],"urlSource":"https://data.nobelprize.org/sparql","key":"lowLemP9fZ"}],"key":"hR5TVXc5dk"}],"class":"dropdown","label":"query-recuento-por-categoria","identifier":"query-recuento-por-categoria","open":true,"html_id":"query-recuento-por-categoria","key":"nNp02kRPTo"},{"type":"heading","depth":2,"position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"text","value":"Categorías y subcategorías","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"rc5aoLoQ0d"}],"identifier":"categor-as-y-subcategor-as","label":"Categorías y subcategorías","html_id":"categor-as-y-subcategor-as","implicit":true,"key":"ugZ19gsad0"},{"type":"paragraph","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"text","value":"En la siguiente consulta, WHERE devuelve instancias para la n-tupla de variables (?premioNobel, ?categoría, ?premiado, ?género). Y GROUP BY especifica ","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"ENEW9PWHPy"},{"type":"strong","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"text","value":"un agrupamiento","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"yhWT0rmE4s"}],"key":"I7HG3Chk4g"},{"type":"text","value":" entre las instancias con el mismo valor para ?categoría ","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"MXjf2onw6c"},{"type":"strong","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"text","value":"y, dentro de cada grupo, una nueva partición","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"qerSVuC8Ti"}],"key":"IXB855I7IU"},{"type":"text","value":" entre las instancias con el mismo valor para ?género.","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"BBxOeElR6v"}],"key":"gTd3SPUQay"},{"type":"paragraph","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"text","value":"Cada uno de estos grupos está compuesto por las distintas instancias (?premioNobel, ?categoría=X, ?premiado, ?género=Y), con X e Y fijas para cada grupo. Los cálculos sobre agregados se pueden realizar ahora dentro de cada grupo sobre los valores de (?premioNobel, ?premiado). La siguiente consulta devuelve los tipos de premios Nobel, diferenciando adicionalmente por género, y en cada apartado se añade su número de premiados.","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"TKIyDDWgPe"}],"key":"b5hp0bDK0M"},{"type":"admonition","kind":"hint","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Consulta: recuento de premiados por categoría y genéro","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"vr7bQyRm1V"}],"key":"GqdNRO0Fl3"},{"type":"code","lang":"SPARQL","value":"PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\nPREFIX nobel: <http://data.nobelprize.org/terms/>\nPREFIX foaf: <http://xmlns.com/foaf/0.1/>\n\nSELECT ?categoría ?género (COUNT(DISTINCT ?premiado) AS ?numPremiadosGrupo)\nWHERE {\n  ?premioNobel rdf:type nobel:NobelPrize .\n  ?premioNobel nobel:category ?categoría .\n  ?premioNobel nobel:laureate ?premiado .\n  ?premiado foaf:gender ?género .\n  \n}\nGROUP BY ?categoría ?género\nORDER BY ?categoría ?género","position":{"start":{"line":87,"column":1},"end":{"line":102,"column":1}},"key":"Rek7j7eWvM"},{"type":"paragraph","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"link","url":"https://data.nobelprize.org/sparql","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"Punto de consulta","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"d9Ck39prsr"}],"urlSource":"https://data.nobelprize.org/sparql","key":"sqpYsEHe5o"}],"key":"kY4FwJopE9"}],"class":"dropdown","label":"query-recuento-por-categoria-genero","identifier":"query-recuento-por-categoria-genero","open":true,"html_id":"query-recuento-por-categoria-genero","key":"xN1uXXqDtc"},{"type":"heading","depth":2,"position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"children":[{"type":"text","value":"Filtrado de categorías","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"ej4ME7gzBF"}],"identifier":"filtrado-de-categor-as","label":"Filtrado de categorías","html_id":"filtrado-de-categor-as","implicit":true,"key":"GvgojhwiOA"},{"type":"paragraph","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"children":[{"type":"text","value":"Cuando se produce una partición mediante el uso de GROUP BY ","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"bc3nwfQRl8"},{"type":"strong","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"children":[{"type":"text","value":"quizá no interese mantener el interés sobre todos los grupos detectados","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"Hcg4WlGJZ2"}],"key":"o9I4zd3LYC"},{"type":"text","value":". Se puede aplicar a estos grupos el concepto de filtrado ya visto con anterioridad y descartar algunos grupos que no cumplen cierta condición. Sintácticamente, en este punto, se usa ","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"k9BN68BXdO"},{"type":"strong","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"children":[{"type":"text","value":"HAVING en vez de FILTER","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"gFIEyDs1nf"}],"key":"RnnF2uo4ib"},{"type":"text","value":" para mantener los grupos que cumplen la condición requerida.","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"yP5Pfih7Pd"}],"key":"fhYLiVvEgJ"},{"type":"paragraph","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"La siguiente consulta agrupa por categoría y genéro, pero tan sólo mantiene aquellos grupos donde la edad mínima a la hora de recibir el premio era mayor de 36. (Es decir, quedan descartados los grupos en que algún premiado tenía menos o igual que 36 años al recibir el premio). De cada uno de estos grupos donde la condición se cumple adicionalmente se calcula en SELECT el recuento de sus premiados.","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"HX3gnbtVTZ"}],"key":"xJUJiwB6JN"},{"type":"admonition","kind":"hint","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Consulta: recuento de premiados por categoría y genéro sólo para ciertos grupos","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"G5XJXloiQn"}],"key":"rwkwoMdFbT"},{"type":"code","lang":"SPARQL","value":"PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\nPREFIX nobel: <http://data.nobelprize.org/terms/>\nPREFIX foaf: <http://xmlns.com/foaf/0.1/>\nPREFIX dbp: <http://dbpedia.org/property/>\n\nSELECT ?categoría ?género (COUNT(DISTINCT ?premiado) AS ?numPremiadosGrupo)\nWHERE {\n  ?premioNobel rdf:type nobel:NobelPrize .\n  ?premioNobel nobel:category ?categoría .\n  ?premioNobel nobel:year ?añoNobel .\n  ?premioNobel nobel:laureate ?premiado .\n  ?premiado foaf:gender ?género .\n  ?premiado dbp:dateOfBirth ?fechaNacim .\n  BIND ((?añoNobel - YEAR(?fechaNacim)) AS ?edadPremiado) .\n}\nGROUP BY ?categoría ?género HAVING (MIN(?edadPremiado) > 36 )\nORDER BY ?categoría ?género","position":{"start":{"line":115,"column":1},"end":{"line":133,"column":1}},"key":"AYHyfaL7ko"},{"type":"paragraph","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"children":[{"type":"text","value":"Sobre esta pregunta se sugiere ir variando el umbral de edad mínima de premiados y observar los grupos que aún cumplen la condicion.","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"AIV3xcY3aj"}],"key":"sXbu6I80NX"},{"type":"paragraph","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"children":[{"type":"link","url":"https://data.nobelprize.org/sparql","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"children":[{"type":"text","value":"Punto de consulta","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"egmvMu8MxK"}],"urlSource":"https://data.nobelprize.org/sparql","key":"reZbUkMvEP"}],"key":"w37eKu6AxH"}],"class":"dropdown","label":"query-recuento-por-categoria-genero-filtrado-grupos","identifier":"query-recuento-por-categoria-genero-filtrado-grupos","open":true,"html_id":"query-recuento-por-categoria-genero-filtrado-grupos","key":"CxoXmM3bNX"}],"key":"vyTvZhmKjM"}],"key":"tgO3JsZcVy"},"references":{"cite":{"order":[],"data":{}}}}